(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8578,        209]
NotebookOptionsPosition[      7953,        190]
NotebookOutlinePosition[      8309,        206]
CellTagsIndexPosition[      8266,        203]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "9"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NUM", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J", "=", 
    RowBox[{"Subsets", "[", 
     RowBox[{
      RowBox[{"Range", "[", "NUM", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "NUM"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CurlyPhi]", "[", 
     RowBox[{"n_", ",", "t_", ",", "j_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "+", 
        RowBox[{"t", "*", 
         RowBox[{"P", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "-", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", " ", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"i", ",", "k"}], "]"}]}], ")"}], "*", " ", 
          RowBox[{"Min", "[", " ", 
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", ",", " ", 
            RowBox[{"P", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "j"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "[", 
    RowBox[{"n_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Max", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CurlyPhi]", "[", 
          RowBox[{"n", ",", "t", ",", "#"}], "]"}], "&"}], ",", "J"}], "]"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"n_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Rho]", "[", 
     RowBox[{"n", ",", "t"}], "]"}], "-", 
    RowBox[{"\[Rho]", "[", 
     RowBox[{"n", ",", 
      RowBox[{"t", "-", "1"}]}], "]"}], "-", 
    RowBox[{"\[Rho]", "[", 
     RowBox[{
      RowBox[{"n", "+", "1"}], ",", "t"}], "]"}], "+", 
    RowBox[{"\[Rho]", "[", 
     RowBox[{
      RowBox[{"n", "+", "1"}], ",", 
      RowBox[{"t", "-", "1"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"n", ",", "0"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "30"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8458870893861055`*^9, 3.845887165016606*^9}, {
   3.8458872848076334`*^9, 3.8458872865734577`*^9}, {3.845887364209575*^9, 
   3.8458873720544243`*^9}, {3.845887419425561*^9, 3.8458874199411864`*^9}, {
   3.845887462985014*^9, 3.8458875820493507`*^9}, {3.8458882994794483`*^9, 
   3.845888303910431*^9}, {3.845888441765117*^9, 3.845888462656765*^9}, {
   3.845889035009364*^9, 3.845889058165825*^9}, 3.8458896751447783`*^9, {
   3.8458897071186223`*^9, 3.845889863127104*^9}, {3.8458899141540346`*^9, 
   3.8458900528269377`*^9}, {3.845890383240223*^9, 3.8458903899215527`*^9}, {
   3.845890460353873*^9, 3.8458905493253765`*^9}, 3.845890581456439*^9, {
   3.8458906183301735`*^9, 3.845890649419117*^9}, {3.8458911965657945`*^9, 
   3.8458912443031235`*^9}, {3.845891365621416*^9, 3.8458913892169685`*^9}, {
   3.845891425853077*^9, 3.8458915958084297`*^9}, {3.845891635007149*^9, 
   3.845891652261655*^9}, {3.845891702181675*^9, 3.8458919014426355`*^9}, {
   3.8458919340725365`*^9, 3.8458920302405868`*^9}, {3.8458921137140255`*^9, 
   3.845892151220722*^9}, {3.845892778955226*^9, 3.8458929114226723`*^9}, {
   3.8458935665792074`*^9, 3.8458935936651554`*^9}, {3.845893640042512*^9, 
   3.8458936461312633`*^9}, {3.845893696431036*^9, 3.845893727564312*^9}, {
   3.845893781568977*^9, 3.845893785132276*^9}, {3.845893974670925*^9, 
   3.8458940993872585`*^9}, {3.8458948759151173`*^9, 
   3.8458949022966385`*^9}, {3.845895003495349*^9, 3.845895129238243*^9}, {
   3.845895295993413*^9, 3.845895390807049*^9}, {3.8458965840660987`*^9, 
   3.845896594488226*^9}, {3.845896730679411*^9, 3.8458967404601994`*^9}, {
   3.845896858419495*^9, 3.845896858534151*^9}, {3.845896910429508*^9, 
   3.845896946369403*^9}, {3.8458970416471834`*^9, 3.845897076133111*^9}, {
   3.845897461523014*^9, 3.8458974752342367`*^9}, {3.84589763600327*^9, 
   3.8458978491230383`*^9}, {3.8458985808572626`*^9, 3.845898601966771*^9}, {
   3.8459354506828585`*^9, 3.8459355664697886`*^9}, {3.8459356041186852`*^9, 
   3.845935635196638*^9}, {3.845943122377757*^9, 3.845943137602487*^9}, {
   3.845943211938684*^9, 3.845943218989936*^9}, {3.845943298997801*^9, 
   3.845943322991946*^9}, {3.845943489393092*^9, 3.845943498740283*^9}, {
   3.845943538908653*^9, 3.8459435479627433`*^9}, {3.8459436077044215`*^9, 
   3.8459436899768205`*^9}, {3.8459437364523673`*^9, 
   3.8459437463988514`*^9}, {3.8459438971315403`*^9, 3.8459439115584946`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"a15c4bfc-5a73-42f6-bb5d-f0d0ac98670b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.84588729068331*^9, 3.845887551933999*^9, 3.845893607674103*^9, 
   3.845893648263749*^9, {3.8458937028868675`*^9, 3.8458937280426607`*^9}, {
   3.8458937823817263`*^9, 3.8458937859621954`*^9}, {3.8458940027955704`*^9, 
   3.845894009541023*^9}, 3.845894100302083*^9, 3.845895393299837*^9, {
   3.8458965867523594`*^9, 3.8458965953264103`*^9}, {3.845896941972596*^9, 
   3.845896947084263*^9}, {3.8458970619114923`*^9, 3.845897076844734*^9}, {
   3.8458974678564234`*^9, 3.845897475973567*^9}, {3.8458977603062706`*^9, 
   3.8458977810903425`*^9}, {3.845897823002737*^9, 3.8458978494805117`*^9}, {
   3.845898585108652*^9, 3.8458986026243997`*^9}, 3.8459354515295315`*^9, {
   3.8459354907194557`*^9, 3.8459355669603553`*^9}, {3.8459356048421774`*^9, 
   3.845935635653837*^9}, {3.845943241729905*^9, 3.8459432423449736`*^9}, {
   3.845943301238537*^9, 3.8459433251580267`*^9}, {3.845943542331879*^9, 
   3.8459435490907702`*^9}, {3.8459436110690813`*^9, 3.845943661430165*^9}, 
   3.8459436915752892`*^9, 3.8459437471233864`*^9, {3.8459438980130024`*^9, 
   3.845943912130024*^9}},
 CellLabel->
  "Out[160]=",ExpressionUUID->"85e1b320-e90f-46bb-9555-44cc3d094af2"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8458978360667653`*^9, 
  3.845897838642111*^9}},ExpressionUUID->"75fb8f50-ca79-4d4f-8db1-\
fed1f5e41dbd"],

Cell[BoxData["3"], "Input",
 CellChangeTimes->{{3.8458872769397507`*^9, 
  3.845887282940485*^9}},ExpressionUUID->"7332e52c-ff7e-47c6-84a5-\
ca8c672da7ae"]
},
WindowSize->{1280, 717},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (2019\:5e745\:67083\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5479, 128, 308, "Input",ExpressionUUID->"a15c4bfc-5a73-42f6-bb5d-f0d0ac98670b"],
Cell[6062, 152, 1560, 25, 65, "Output",ExpressionUUID->"85e1b320-e90f-46bb-9555-44cc3d094af2"]
}, Open  ]],
Cell[7637, 180, 154, 3, 28, "Input",ExpressionUUID->"75fb8f50-ca79-4d4f-8db1-fed1f5e41dbd"],
Cell[7794, 185, 155, 3, 28, "Input",ExpressionUUID->"7332e52c-ff7e-47c6-84a5-ca8c672da7ae"]
}
]
*)

